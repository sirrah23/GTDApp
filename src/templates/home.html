<html>
  <head>
    <title>GTD App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <link href="static/bootstrap.min.css" rel="stylesheet" media="screen">
  </head>
  <body>
    {% raw %}
    <div class="container">
      <div id="app">
          <!-- TODO: Inline these buttons...flexbox? -->
          <span id="button-back"><button v-on:click="toggleModeBackward()"><<<</button>
          <span id="mode"> <h1>{{ modeStr }}</h1></span>
          <span id="button-forward"><button v-on:click="toggleModeForward()">>>></button>
          <!-- Items or Someday/Maybe list -->
          <ul id="items" v-if="mode === 0 || mode === 1">
              <li v-for="item in items" v-if="item.location === modeStr.toLowerCase()">
                  {{ item.description }}
              </li>
          </ul>
          <!-- Task List -->
          <ul id="tasks" v-if="mode === 2">
              <li v-for="task in tasks">
                  {{ task.description }} ---- {{ task.status.toUpperCase() }}
              </li>
          </ul>
          <!-- Project List -->
          <ul id="projects" v-if="mode === 3">
              <li v-for="project in projects">
                task.description
                <ul class="project-tasks">
                    <li v-for="task in project.tasks">
                        <!-- TODO: Task component? We could abstract it and use it in two places-->
                        {{ task.description }} ---- {{ task.status.toUpperCase() }}
                    </li>
                </ul>
              </li>
          </ul>
      </div>
    </div>
    {% endraw %}
    <a href="/logout">Logout</a>
  </body>
  <script>
    var app = new Vue({
        el: '#app',
        data: {
            mode: 0,
            modeStrs: ["Inbox", "Someday/Maybe", "Tasks", "Projects"],
            // TODO: Unhardcode this stuff once we have the api
            items: [
                {id: "1", description: "A random thought", location: "inbox"},
                {id: "2", description: "Another random thought", location: "inbox"},
                {id: "3", description: "Project A", location: "inbox"},
                {id: "4", description: "I should buy a house", location: "someday/maybe"},
                {id: "5", description: "I should buy a boat", location: "someday/maybe"}
            ],
            tasks: [
                {id: "6", description: "Task 1", status: "todo"},
                {id: "7", description: "Task 2", status: "todo"},
                {id: "8", description: "Task 3", status: "done"},
            ],
            projects: [
                {id: "9", description: "Project A", tasks:[]},
                {id: "10",
                 description: "Project B",
                 tasks:[
                     {id: "12", description: "Project A Task 1", status: "next"},
                     {id: "13", description: "Project A Task 2", status: "todo"},
                 ]
                },
                {id: "11", description: "Project C",
                 tasks:[
                     {id: "14", description: "Project C Task 1", status: "todo"},
                 ]
                },
            ]
        },
        computed: {
            modeStr(){
                return this.modeStrs[this.mode];
            }
        },
        methods: {
            //TODO: Create a generic number-wrap function for both toggle-forward and toggle-backward
            toggleModeForward(){
                this.mode = (this.mode + 1) % this.modeStrs.length; 
            },
            toggleModeBackward(){
                this.mode = (this.mode - 1);
                if(this.mode < 0){
                    this.mode = this.modeStrs.length - 1;
                }
            },
        }
    })
  </script>
</html>
